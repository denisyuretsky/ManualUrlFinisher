(()=>{"use strict";var __webpack_modules__={"./src/popup/popup.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _shared_constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../shared/constants */ "./src/shared/constants.ts");\n/* harmony import */ var _shared_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../shared/storage */ "./src/shared/storage.ts");\n\n\n\nlet tempResult = [];\nlet contentUrl = _shared_constants__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_CONTENT_URL;\nlet tempHistory = {};\nconst resultElement = document.getElementById("muf-options-result");\nconst historyListElement = document.getElementById("muf-history-list");\nconst clearAllHistoryElement = document.getElementById("muf-history-clear-all");\nconst composeResultText = () => tempResult.map((number) => (number == _shared_constants__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_NUMBER ? _shared_constants__WEBPACK_IMPORTED_MODULE_0__.DISPLAY_NAME_FOR_DEFAULT_NUMBER : number)).join("");\nconst updateDisplayedResult = () => {\n    const resultText = composeResultText();\n    resultElement.textContent = resultText;\n    return resultText;\n};\nconst addValueToTempHistory = (key) => {\n    var _a;\n    const now = Date.now();\n    tempHistory[key] = (_a = tempHistory[key]) !== null && _a !== void 0 ? _a : { count: 0, timestamp: now };\n    tempHistory[key].count++;\n    tempHistory[key].timestamp = now;\n    // Store only 10 items in the history. Delete the oldest one. \n    const keys = Object.keys(tempHistory).map(key => Number(key));\n    if (keys.length > 10) {\n        const oldestKey = keys.reduce((a, b) => (tempHistory[a].timestamp < tempHistory[b].timestamp ? a : b));\n        delete tempHistory[oldestKey];\n    }\n};\nconst openChromeTab = (value) => {\n    chrome.tabs.create({ url: `${contentUrl}${value}` })\n        .catch((error) => {\n        console.error("Error while opening a tab:", error);\n    });\n};\nconst handleHistory = (action, value, callBack) => {\n    switch (action) {\n        case "add":\n            addValueToTempHistory(Number(value));\n            break;\n        case "delete":\n            if (tempHistory.hasOwnProperty(Number(value))) {\n                delete tempHistory[Number(value)];\n            }\n            break;\n        case "clearAll":\n            tempHistory = {};\n            break;\n        default:\n            break;\n    }\n    (0,_shared_storage__WEBPACK_IMPORTED_MODULE_1__.saveStorageData)({ history: tempHistory }).then(() => {\n        updateDisplayedHistory();\n        if (callBack && typeof value === \'string\' && value.length > 0) {\n            callBack(value);\n        }\n    })\n        .catch((error) => {\n        console.error("Error while saving storage data:", error);\n    });\n    ;\n};\nconst addClearButton = (li, value) => {\n    const clearIcon = document.createElement("span");\n    clearIcon.className = "clear-icon";\n    clearIcon.innerHTML = "&#128711;"; // HTML of Prohibited Sign\n    clearIcon.title = "Delete";\n    clearIcon.addEventListener("click", (event) => {\n        event.stopPropagation(); // prevent click on li\n        handleHistory("delete", value);\n    });\n    li.appendChild(clearIcon);\n};\nconst createListItemElement = (key, value) => {\n    const li = document.createElement("li");\n    li.className = "muf-history-item";\n    li.textContent = `${key}${value.count > 1 ? ` (${value.count})` : \'\'}`;\n    addClearButton(li, key);\n    li.addEventListener("click", () => handleHistory("add", key, openChromeTab));\n    return li;\n};\nconst updateDisplayedHistory = () => {\n    historyListElement.innerHTML = \'\';\n    const sortedEntries = Object.entries(tempHistory).sort(([, a], [, b]) => b.timestamp - a.timestamp);\n    if (sortedEntries.length === 0) {\n        return;\n    }\n    const fragment = document.createDocumentFragment();\n    sortedEntries.forEach(([key, value]) => fragment.appendChild(createListItemElement(key, value)));\n    historyListElement.appendChild(fragment);\n};\nconst areAllNumbersEntered = () => tempResult.every((number) => number >= 0);\nconst handleCellClick = (e) => {\n    const { cellIndex, innerText } = e.target;\n    tempResult[cellIndex] = Number(innerText);\n    const resultText = updateDisplayedResult();\n    if (areAllNumbersEntered()) {\n        handleHistory("add", resultText, openChromeTab);\n    }\n};\nconst initialize = () => {\n    (0,_shared_storage__WEBPACK_IMPORTED_MODULE_1__.loadStorageData)().then((storageData) => {\n        var table = document.getElementById("muf-options-table");\n        tempResult = [...storageData.numbers];\n        contentUrl = storageData.contentUrl;\n        tempHistory = storageData.history;\n        storageData.numbers.forEach((number, index) => {\n            var _a;\n            const cell = (_a = table.rows[number]) === null || _a === void 0 ? void 0 : _a.cells[index];\n            if (number >= 0 && cell !== undefined) {\n                table.rows[number].cells[index].classList.add("selected");\n            }\n        });\n        updateDisplayedResult();\n        updateDisplayedHistory();\n    })\n        .catch((error) => {\n        console.error("Error while loading storage data:", error);\n    });\n};\ndocument.addEventListener("DOMContentLoaded", () => {\n    initialize();\n    document.querySelectorAll("td").forEach((cell) => cell.addEventListener("click", handleCellClick));\n    clearAllHistoryElement.addEventListener("click", () => handleHistory("clearAll"));\n});\n\n\n//# sourceURL=webpack://manualurlfinisher/./src/popup/popup.ts?')},"./src/shared/constants.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DEFAULT_CONTENT_URL: () => (/* binding */ DEFAULT_CONTENT_URL),\n/* harmony export */   DEFAULT_NUMBER: () => (/* binding */ DEFAULT_NUMBER),\n/* harmony export */   DISPLAY_NAME_FOR_DEFAULT_NUMBER: () => (/* binding */ DISPLAY_NAME_FOR_DEFAULT_NUMBER),\n/* harmony export */   ROWS_COUNT: () => (/* binding */ ROWS_COUNT)\n/* harmony export */ });\nconst ROWS_COUNT = 4;\nconst DEFAULT_NUMBER = -1;\nconst DISPLAY_NAME_FOR_DEFAULT_NUMBER = "X";\nconst DEFAULT_CONTENT_URL = "";\n\n\n//# sourceURL=webpack://manualurlfinisher/./src/shared/constants.ts?')},"./src/shared/storage.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   loadStorageData: () => (/* binding */ loadStorageData),\n/* harmony export */   saveStorageData: () => (/* binding */ saveStorageData)\n/* harmony export */ });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants */ "./src/shared/constants.ts");\n\nconst loadStorageData = (defaults = {\n    contentUrl: _constants__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_CONTENT_URL,\n    numbers: Array(_constants__WEBPACK_IMPORTED_MODULE_0__.ROWS_COUNT).fill(_constants__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_NUMBER),\n    history: {}\n}) => {\n    return new Promise((resolve, reject) => {\n        chrome.storage.local.get(defaults, (storageData) => {\n            if (chrome.runtime.lastError) {\n                return reject(new Error(chrome.runtime.lastError.message));\n            }\n            resolve(storageData);\n        });\n    });\n};\nconst saveStorageData = (data) => {\n    return new Promise((resolve, reject) => {\n        chrome.storage.local.set(data, () => {\n            if (chrome.runtime.lastError) {\n                return reject(new Error(chrome.runtime.lastError.message));\n            }\n            resolve();\n        });\n    });\n};\n\n\n//# sourceURL=webpack://manualurlfinisher/./src/shared/storage.ts?')}},__webpack_module_cache__={};function __webpack_require__(e){var n=__webpack_module_cache__[e];if(void 0!==n)return n.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.exports}__webpack_require__.d=(e,n)=>{for(var t in n)__webpack_require__.o(n,t)&&!__webpack_require__.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},__webpack_require__.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var __webpack_exports__=__webpack_require__("./src/popup/popup.ts")})();